<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Interactive Hardware : Interactive Hardware (CS 807) " />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Interactive Hardware</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/trevortomesh/InteractiveHardware">View on GitHub</a>

          <h1 id="project_title">Interactive Hardware</h1>
          <h2 id="project_tagline">Interactive Hardware (CS 807) </h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/trevortomesh/InteractiveHardware/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/trevortomesh/InteractiveHardware/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h3>
<a name="welcome-to-my-cs-807---interactive-hardware-blog" class="anchor" href="#welcome-to-my-cs-807---interactive-hardware-blog"><span class="octicon octicon-link"></span></a>Welcome to my CS 807 - Interactive Hardware Blog</h3>

<p>I created this blog for two reasons:
1. I needed a better way to submit my assignments to my instructor and
2. I want to have a nice record of the work I've done as I will most likely regret not being able to find it sometime down the line. </p>

<p><strong>Please Note: Everything here is published as public domain</strong></p>

<p>I mean, copyrights suck -- like, hard. And, besides, there's probably nothing here worth copyrighting
If you <strong>do</strong> find anything here interesting and want to copy it, I'd appreciate some attribution,
but, hey, <a href="hotlinemiami.com">it's not like I am going to come after you with a baseball-bat wearing a chicken mask or something.</a></p>

<hr><h3>
<a name="assignment-3-doin-stuff-with-motors-and-servos--shift-registers" class="anchor" href="#assignment-3-doin-stuff-with-motors-and-servos--shift-registers"><span class="octicon octicon-link"></span></a>Assignment 3: Doin' stuff with motors and servos / shift registers</h3>

<p>For this assignment, we played around with the arduino and motors and shift registers (as the title
would suggest). </p>

<p><strong><em>Part 1: DC Motor</em></strong></p>

<p>Following the <a href="http://oomlout.com/a/products/ardx/circ-03/">Oomlaut ARDX Circ-03 tutorial</a> for DC motors I wound up with this beautiful disaster:</p>

<p><img src="https://raw.github.com/trevortomesh/InteractiveHardware/fab20d3b0d0583027e5e4cb0d14532252c6e9780/assignments/a3/20140130_221143.jpg" alt=""></p>

<p>This set-up is very simple with with very simple code (once again, taken from the <a href="http://oomlout.com/a/products/ardx/circ-03/">CIRC-03 tutorial</a>: </p>

<div class="highlight highlight-C++"><pre><span class="cm">/*     ———————————————————–</span>
<span class="cm">*     |  Arduino Experimentation Kit Example Code               |</span>
<span class="cm">*     |  CIRC-03 .: Spin Motor Spin :. (Transistor and Motor)   |</span>
<span class="cm">*     ———————————————————–</span>
<span class="cm">*</span>
<span class="cm">* The Arduinos pins are great for driving LEDs however if you hook</span>
<span class="cm">* up something that requires more power you will quickly break them.</span>
<span class="cm">* To control bigger items we need the help of a transistor.</span>
<span class="cm">* Here we will use a transistor to control a small toy motor</span>
<span class="cm">*</span>
<span class="cm">* http://tinyurl.com/d4wht7</span>
<span class="cm">*</span>
<span class="cm">*/</span>

<span class="kt">int</span> <span class="n">motorPin</span> <span class="o">=</span> <span class="mi">9</span><span class="p">;</span>  <span class="c1">// define the pin the motor is connected to</span>
                   <span class="c1">// (if you use pin 9,10,11 or 3you can also control speed)</span>

<span class="cm">/*</span>
<span class="cm">* setup() – this function runs once when you turn your Arduino on</span>
<span class="cm">* We set the motors pin to be an output (turning the pin high (+5v) or low (ground) (-))</span>
<span class="cm">* rather than an input (checking whether a pin is high or low)</span>
<span class="cm">*/</span>
<span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span>
<span class="p">{</span>
<span class="n">pinMode</span><span class="p">(</span><span class="n">motorPin</span><span class="p">,</span> <span class="n">OUTPUT</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm">* loop() – this function will start after setup finishes and then repeat</span>
<span class="cm">* we call a function called motorOnThenOff()</span>
<span class="cm">*/</span>

<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span>                     <span class="c1">// run over and over again</span>
<span class="p">{</span>
<span class="n">motorOnThenOff</span><span class="p">();</span>
<span class="c1">//motorOnThenOffWithSpeed();</span>
<span class="c1">//motorAcceleration();</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm">* motorOnThenOff() – turns motor on then off</span>
<span class="cm">* (notice this code is identical to the code we used for</span>
<span class="cm">* the blinking LED)</span>
<span class="cm">*/</span>
<span class="kt">void</span> <span class="nf">motorOnThenOff</span><span class="p">(){</span>
  <span class="kt">int</span> <span class="n">onTime</span> <span class="o">=</span> <span class="mi">2500</span><span class="p">;</span>  <span class="c1">//the number of milliseconds for the motor to turn on for</span>
  <span class="kt">int</span> <span class="n">offTime</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">;</span> <span class="c1">//the number of milliseconds for the motor to turn off for</span>

  <span class="n">digitalWrite</span><span class="p">(</span><span class="n">motorPin</span><span class="p">,</span> <span class="n">HIGH</span><span class="p">);</span> <span class="c1">// turns the motor On</span>
  <span class="n">delay</span><span class="p">(</span><span class="n">onTime</span><span class="p">);</span>                <span class="c1">// waits for onTime milliseconds</span>
  <span class="n">digitalWrite</span><span class="p">(</span><span class="n">motorPin</span><span class="p">,</span> <span class="n">LOW</span><span class="p">);</span>  <span class="c1">// turns the motor Off</span>
  <span class="n">delay</span><span class="p">(</span><span class="n">offTime</span><span class="p">);</span>               <span class="c1">// waits for offTime milliseconds</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm">* motorOnThenOffWithSpeed() – turns motor on then off but uses speed values as well</span>
<span class="cm">* (notice this code is identical to the code we used for</span>
<span class="cm">* the blinking LED)</span>
<span class="cm">*/</span>
<span class="kt">void</span> <span class="nf">motorOnThenOffWithSpeed</span><span class="p">(){</span>

  <span class="kt">int</span> <span class="n">onSpeed</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span>  <span class="c1">// a number between 0 (stopped) and 255 (full speed)</span>
  <span class="kt">int</span> <span class="n">onTime</span> <span class="o">=</span> <span class="mi">2500</span><span class="p">;</span>  <span class="c1">//the number of milliseconds for the motor to turn on for</span>

  <span class="kt">int</span> <span class="n">offSpeed</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span>  <span class="c1">// a number between 0 (stopped) and 255 (full speed)</span>
  <span class="kt">int</span> <span class="n">offTime</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">;</span> <span class="c1">//the number of milliseconds for the motor to turn off for</span>

  <span class="n">analogWrite</span><span class="p">(</span><span class="n">motorPin</span><span class="p">,</span> <span class="n">onSpeed</span><span class="p">);</span>   <span class="c1">// turns the motor On</span>
  <span class="n">delay</span><span class="p">(</span><span class="n">onTime</span><span class="p">);</span>                    <span class="c1">// waits for onTime milliseconds</span>
  <span class="n">analogWrite</span><span class="p">(</span><span class="n">motorPin</span><span class="p">,</span> <span class="n">offSpeed</span><span class="p">);</span>  <span class="c1">// turns the motor Off</span>
  <span class="n">delay</span><span class="p">(</span><span class="n">offTime</span><span class="p">);</span>                   <span class="c1">// waits for offTime milliseconds</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm">* motorAcceleration() – accelerates the motor to full speed then</span>
<span class="cm">* back down to zero</span>
<span class="cm">*/</span>
<span class="kt">void</span> <span class="nf">motorAcceleration</span><span class="p">(){</span>
  <span class="kt">int</span> <span class="n">delayTime</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span> <span class="c1">//milliseconds between each speed step</span>

  <span class="c1">//Accelerates the motor</span>
  <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">256</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span> <span class="c1">//goes through each speed from 0 to 255</span>
    <span class="n">analogWrite</span><span class="p">(</span><span class="n">motorPin</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>   <span class="c1">//sets the new speed</span>
    <span class="n">delay</span><span class="p">(</span><span class="n">delayTime</span><span class="p">);</span>           <span class="c1">// waits for delayTime milliseconds</span>
  <span class="p">}</span>

  <span class="c1">//Decelerates the motor</span>
  <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">255</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">--</span><span class="p">){</span> <span class="c1">//goes through each speed from 255 to 0</span>
    <span class="n">analogWrite</span><span class="p">(</span><span class="n">motorPin</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>   <span class="c1">//sets the new speed</span>
    <span class="n">delay</span><span class="p">(</span><span class="n">delayTime</span><span class="p">);</span>           <span class="c1">// waits for delayTime milliseconds</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>In a nut-shell, this code pulses a DC Motor that is connected to pin 9. It is nearly exactly like the "blink code" except with an analogWrite. </p>

<p>I wanted to do something a little more interesting with this circuit, so I removed the resistor and replaced it with a photo-resistor:
<img src="https://raw.github.com/trevortomesh/InteractiveHardware/fab20d3b0d0583027e5e4cb0d14532252c6e9780/assignments/a3/20140130_221254.jpg" alt=""></p>

<p>It may not look like much... because it really isn't, but there's some rather entertaining implications of replacing the regular resistor with a photo-resistor. When we normally think about "autonomous agents" that have the ability to "sense" their environment -- we tend to think of a three step process: </p>

<p>Sensing --&gt; Processing --&gt; Acting</p>

<p>That is, an agent senses a stimuli in its environment, makes a decision as to how to react and then acts upon it (or not, depending upon what sort of decision it makes). Had I wired the photo-resistor to an analog port and instructed the MCU to rotate the motor according to how much light was detected, that would be according to the sense-think-act model. However, I did not. Rather, I inserted the resistor directly into the circuit so that the motor speed would change as a result of the resistance of the photo-resistor! There is no "processing involved". This sort of machine is known as a <a href="http://en.wikipedia.org/wiki/Braitenberg_vehicle">Braitenberg Vehicle</a>. I could go on for hours about behavior-based robotics and how Braitenberg vehicles are awesome and what implication they have on the nature of the universe -- but will save that for another time. </p>

<p><strong><em>Part 2: Servo</em></strong></p>

<p>For part 2, I followed <a href="http://oomlout.com/a/products/ardx/circ-04/">CIRC-04</a> of the ARDX kit to build a little servo-circuit that runs a boring little program: </p>

<div class="highlight highlight-C++"><pre><span class="c1">// Sweep</span>
<span class="c1">// by BARRAGAN</span>

<span class="cp">#include &lt;Servo.h&gt;</span>

<span class="n">Servo</span> <span class="n">myservo</span><span class="p">;</span>  <span class="c1">// create servo object to control a servo</span>
                <span class="c1">// a maximum of eight servo objects can be created</span>

<span class="kt">int</span> <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>    <span class="c1">// variable to store the servo position</span>

<span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">myservo</span><span class="p">.</span><span class="n">attach</span><span class="p">(</span><span class="mi">9</span><span class="p">);</span>  <span class="c1">// attaches the servo on pin 9 to the servo object</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span>
<span class="p">{</span>
  <span class="k">for</span><span class="p">(</span><span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">pos</span> <span class="o">&lt;</span> <span class="mi">180</span><span class="p">;</span> <span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1">// goes from 0 degrees to 180 degrees</span>
  <span class="p">{</span>                                  <span class="c1">// in steps of 1 degree</span>
    <span class="n">myservo</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">pos</span><span class="p">);</span>              <span class="c1">// tell servo to go to position in variable 'pos'</span>
    <span class="n">delay</span><span class="p">(</span><span class="mi">15</span><span class="p">);</span>                       <span class="c1">// waits 15ms for the servo to reach the position</span>
  <span class="p">}</span>
  <span class="k">for</span><span class="p">(</span><span class="n">pos</span> <span class="o">=</span> <span class="mi">180</span><span class="p">;</span> <span class="n">pos</span><span class="o">&gt;=</span><span class="mi">1</span><span class="p">;</span> <span class="n">pos</span><span class="o">-=</span><span class="mi">1</span><span class="p">)</span>     <span class="c1">// goes from 180 degrees to 0 degrees</span>
  <span class="p">{</span>                                
    <span class="n">myservo</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">pos</span><span class="p">);</span>              <span class="c1">// tell servo to go to position in variable ‘pos’</span>
    <span class="n">delay</span><span class="p">(</span><span class="mi">15</span><span class="p">);</span>                       <span class="c1">// waits 15ms for the servo to reach the position</span>
  <span class="p">}</span>
<span class="p">}</span> 
</pre></div>

<p>The set-up: </p>

<p><img src="https://raw.github.com/trevortomesh/InteractiveHardware/fab20d3b0d0583027e5e4cb0d14532252c6e9780/assignments/a3/20140130_222729.jpg" alt=""></p>

<p>Not too much interesting here. The code steps the servo through 180 degrees in one direction and then returns. However, I thought back to a project that I did as an undergraduate where I drove a physical pendulum with the oscillating signal from a simulated <a href="http://adsabs.harvard.edu/abs/2010APS..MAR.K1013T">squid-giant axon</a> (the result of which will forever be pejoratively known as "robo-squid" at the University of Wisconsin - River Falls) -- which provided a it of inspiration.</p>

<p>Anyhow, I decided that now might be a good time to, perhaps, re-visit the idea. The original "robosquid" code was written in python, so I decided to get my hands dirty with some python-serial communication. The resulting code: </p>

<div class="highlight highlight-Python"><pre><span class="c">#!/usr/bin/env python</span>
<span class="kn">import</span> <span class="nn">serial</span>

<span class="n">pos</span><span class="o">=</span><span class="nb">input</span><span class="p">(</span><span class="s">"'H' or 'L'?   "</span><span class="p">)</span>


<span class="n">ser</span> <span class="o">=</span> <span class="n">serial</span><span class="o">.</span><span class="n">Serial</span><span class="p">(</span><span class="s">'/dev/ttyACM0'</span><span class="p">,</span> <span class="mi">9600</span><span class="p">)</span>

<span class="n">ser</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</pre></div>

<p>This code, very simply, prompts the user for a value of 'H' or 'L' and, depending upon what the user selects, will write to the serial port that the arduino is located at. </p>

<p>The functional arduino test-code looks like this: </p>

<div class="highlight highlight-C++"><pre><span class="c1">// Sweep</span>
<span class="c1">// by BARRAGAN &lt;http://barraganstudio.com&gt; </span>

<span class="cp">#include &lt;Servo.h&gt; </span>

<span class="n">Servo</span> <span class="n">myservo</span><span class="p">;</span>  <span class="c1">// create servo object to control a servo </span>
                <span class="c1">// a maximum of eight servo objects can be created </span>

<span class="kt">int</span> <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>    <span class="c1">// variable to store the servo position </span>
<span class="kt">int</span> <span class="n">del</span> <span class="o">=</span> <span class="mi">15</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span> 
<span class="p">{</span> 
  <span class="n">Serial</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">9600</span><span class="p">);</span>        <span class="c1">// connect to the serial port</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Arduino is ready"</span><span class="p">);</span>
  <span class="n">myservo</span><span class="p">.</span><span class="n">attach</span><span class="p">(</span><span class="mi">9</span><span class="p">);</span>  <span class="c1">// attaches the servo on pin 9 to the servo object </span>
<span class="p">}</span> 


<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span> 
<span class="p">{</span> 
  <span class="k">for</span><span class="p">(</span><span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">pos</span> <span class="o">&lt;</span> <span class="mi">180</span><span class="p">;</span> <span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1">// goes from 0 degrees to 180 degrees </span>
  <span class="p">{</span>                                  <span class="c1">// in steps of 1 degree </span>
    <span class="n">myservo</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">pos</span><span class="p">);</span>              <span class="c1">// tell servo to go to position in variable 'pos' </span>
    <span class="n">delay</span><span class="p">(</span><span class="n">del</span><span class="p">);</span>                       <span class="c1">// waits 15ms for the servo to reach the position </span>
  <span class="p">}</span> 
  <span class="k">for</span><span class="p">(</span><span class="n">pos</span> <span class="o">=</span> <span class="mi">180</span><span class="p">;</span> <span class="n">pos</span><span class="o">&gt;=</span><span class="mi">1</span><span class="p">;</span> <span class="n">pos</span><span class="o">-=</span><span class="mi">1</span><span class="p">)</span>     <span class="c1">// goes from 180 degrees to 0 degrees </span>
  <span class="p">{</span>                                
    <span class="n">myservo</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">pos</span><span class="p">);</span>              <span class="c1">// tell servo to go to position in variable 'pos' </span>
    <span class="n">delay</span><span class="p">(</span><span class="n">del</span><span class="p">);</span>                       <span class="c1">// waits 15ms for the servo to reach the position </span>
  <span class="p">}</span> 

    <span class="kt">int</span> <span class="n">serbyte</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>


  <span class="n">serbyte</span> <span class="o">=</span> <span class="n">Serial</span><span class="p">.</span><span class="n">read</span><span class="p">();</span>
  <span class="c1">// if the input is '-1' then there is no data</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">serbyte</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">serbyte</span> <span class="o">==</span> <span class="sc">'H'</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">Serial</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="sc">'H'</span><span class="p">);</span>
      <span class="n">del</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">serbyte</span> <span class="o">==</span> <span class="sc">'L'</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="n">Serial</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="sc">'L'</span><span class="p">);</span>
    <span class="n">del</span> <span class="o">=</span> <span class="mi">15</span><span class="p">;</span>

    <span class="p">}</span>


<span class="p">}</span> 
<span class="p">}</span>
</pre></div>

<p>In a nutshell, given the user input of 'H' or 'L' the arduino will respond by either speeding up or slowing down. This is accomplished simply by changing the value of the delay (hence the variable <em>del</em>). This is very interesting because it allows for the servo to be controlled by python code running on the computer. There are a number of interesting applications for this (the resurrection of robosquid being one) including the ability to interact with the Blender Game Engine -- which uses Python as a scripting language. </p>

<p><strong><em>Part 3: Shift Register</em></strong></p>

<p><a href="http://oomlout.com/a/products/ardx/circ-05/">CIRC-5</a> involved using a shift register to run a set of 8 LED's off of just three pins.</p>

<p>The set-up:
<img src="https://raw.github.com/trevortomesh/InteractiveHardware/gh-pages/assignments/a3/20140131_004956.jpg" alt=""></p>

<p>Yikes! And the code: </p>

<div class="highlight highlight-C++"><pre><span class="cm">/*     ———————————————————</span>
<span class="cm">*     |  Arduino Experimentation Kit Example Code             |</span>
<span class="cm">*     |  CIRC-05 .: 8 More LEDs :. (74HC595 Shift Register)   |</span>
<span class="cm">*     ———————————————————</span>
<span class="cm">*</span>
<span class="cm">* We have already controlled 8 LEDs however this does it in a slightly</span>
<span class="cm">* different manner. Rather than using 8 pins we will use just three</span>
<span class="cm">* and an additional chip.</span>
<span class="cm">*</span>
<span class="cm">*</span>
<span class="cm">*/</span>

<span class="c1">//Pin Definitions</span>
<span class="c1">//The 74HC595 using a protocol called SPI (for more details http://www.arduino.cc/en/Tutorial/ShiftOut)</span>
<span class="c1">//Which has three pins</span>
<span class="kt">int</span> <span class="n">data</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">clock</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">latch</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>

<span class="c1">//Used for single LED manipulation</span>
<span class="kt">int</span> <span class="n">ledState</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">ON</span> <span class="o">=</span> <span class="n">HIGH</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">OFF</span> <span class="o">=</span> <span class="n">LOW</span><span class="p">;</span>


<span class="cm">/*</span>
<span class="cm">* setup() – this function runs once when you turn your Arduino on</span>
<span class="cm">* We set the three control pins to outputs</span>
<span class="cm">*/</span>
<span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">pinMode</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">OUTPUT</span><span class="p">);</span>
  <span class="n">pinMode</span><span class="p">(</span><span class="n">clock</span><span class="p">,</span> <span class="n">OUTPUT</span><span class="p">);</span>  
  <span class="n">pinMode</span><span class="p">(</span><span class="n">latch</span><span class="p">,</span> <span class="n">OUTPUT</span><span class="p">);</span>  
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm">* loop() – this function will start after setup finishes and then repeat</span>
<span class="cm">* we set which LEDs we want on then call a routine which sends the states to the 74HC595</span>
<span class="cm">*/</span>
<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span>                     <span class="c1">// run over and over again</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">delayTime</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span> <span class="c1">//the number of milliseconds to delay between LED updates</span>
  <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">256</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
   <span class="n">updateLEDs</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
   <span class="n">delay</span><span class="p">(</span><span class="n">delayTime</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm">* updateLEDs() - sends the LED states set in ledStates to the 74HC595</span>
<span class="cm">* sequence</span>
<span class="cm">*/</span>
<span class="kt">void</span> <span class="nf">updateLEDs</span><span class="p">(</span><span class="kt">int</span> <span class="n">value</span><span class="p">){</span>
  <span class="n">digitalWrite</span><span class="p">(</span><span class="n">latch</span><span class="p">,</span> <span class="n">LOW</span><span class="p">);</span>     <span class="c1">//Pulls the chips latch low</span>
  <span class="n">shiftOut</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">clock</span><span class="p">,</span> <span class="n">MSBFIRST</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span> <span class="c1">//Shifts out the 8 bits to the shift register</span>
  <span class="n">digitalWrite</span><span class="p">(</span><span class="n">latch</span><span class="p">,</span> <span class="n">HIGH</span><span class="p">);</span>   <span class="c1">//Pulls the latch high displaying the data</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm">* updateLEDsLong() - sends the LED states set in ledStates to the 74HC595</span>
<span class="cm">* sequence. Same as updateLEDs except the shifting out is done in software</span>
<span class="cm">* so you can see what is happening.</span>
<span class="cm">*/</span>
<span class="kt">void</span> <span class="nf">updateLEDsLong</span><span class="p">(</span><span class="kt">int</span> <span class="n">value</span><span class="p">){</span>
  <span class="n">digitalWrite</span><span class="p">(</span><span class="n">latch</span><span class="p">,</span> <span class="n">LOW</span><span class="p">);</span>    <span class="c1">//Pulls the chips latch low</span>
  <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>  <span class="c1">//Will repeat 8 times (once for each bit)</span>
  <span class="kt">int</span> <span class="n">bit</span> <span class="o">=</span> <span class="n">value</span> <span class="o">&amp;</span> <span class="n">B10000000</span><span class="p">;</span> <span class="c1">//We use a "bitmask" to select only the eighth</span>
                               <span class="c1">//bit in our number (the one we are addressing this time through</span>
  <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">;</span>          <span class="c1">//we move our number up one bit value so next time bit 7 will be</span>
                               <span class="c1">//bit 8 and we will do our math on it</span>
  <span class="k">if</span><span class="p">(</span><span class="n">bit</span> <span class="o">==</span> <span class="mi">128</span><span class="p">){</span><span class="n">digitalWrite</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">HIGH</span><span class="p">);}</span> <span class="c1">//if bit 8 is set then set our data pin high</span>
  <span class="k">else</span><span class="p">{</span><span class="n">digitalWrite</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">LOW</span><span class="p">);}</span>            <span class="c1">//if bit 8 is unset then set the data pin low</span>
  <span class="n">digitalWrite</span><span class="p">(</span><span class="n">clock</span><span class="p">,</span> <span class="n">HIGH</span><span class="p">);</span>                <span class="c1">//the next three lines pulse the clock pin</span>
  <span class="n">delay</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="n">digitalWrite</span><span class="p">(</span><span class="n">clock</span><span class="p">,</span> <span class="n">LOW</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">digitalWrite</span><span class="p">(</span><span class="n">latch</span><span class="p">,</span> <span class="n">HIGH</span><span class="p">);</span>  <span class="c1">//pulls the latch high shifting our data into being displayed</span>
<span class="p">}</span>

<span class="c1">//These are used in the bitwise math that we use to change individual LEDs</span>
<span class="c1">//For more details http://en.wikipedia.org/wiki/Bitwise_operation</span>
<span class="kt">int</span> <span class="n">bits</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="n">B00000001</span><span class="p">,</span> <span class="n">B00000010</span><span class="p">,</span> <span class="n">B00000100</span><span class="p">,</span> <span class="n">B00001000</span><span class="p">,</span> <span class="n">B00010000</span><span class="p">,</span> <span class="n">B00100000</span><span class="p">,</span> <span class="n">B01000000</span><span class="p">,</span> <span class="n">B10000000</span><span class="p">};</span>
<span class="kt">int</span> <span class="n">masks</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="n">B11111110</span><span class="p">,</span> <span class="n">B11111101</span><span class="p">,</span> <span class="n">B11111011</span><span class="p">,</span> <span class="n">B11110111</span><span class="p">,</span> <span class="n">B11101111</span><span class="p">,</span> <span class="n">B11011111</span><span class="p">,</span> <span class="n">B10111111</span><span class="p">,</span> <span class="n">B01111111</span><span class="p">};</span>
<span class="cm">/*</span>
<span class="cm">* changeLED(int led, int state) - changes an individual LED</span>
<span class="cm">* LEDs are 0 to 7 and state is either 0 - OFF or 1 - ON</span>
<span class="cm">*/</span>
<span class="kt">void</span> <span class="nf">changeLED</span><span class="p">(</span><span class="kt">int</span> <span class="n">led</span><span class="p">,</span> <span class="kt">int</span> <span class="n">state</span><span class="p">){</span>
   <span class="n">ledState</span> <span class="o">=</span> <span class="n">ledState</span> <span class="o">&amp;</span> <span class="n">masks</span><span class="p">[</span><span class="n">led</span><span class="p">];</span>  <span class="c1">//clears ledState of the bit we are addressing</span>
   <span class="k">if</span><span class="p">(</span><span class="n">state</span> <span class="o">==</span> <span class="n">ON</span><span class="p">){</span><span class="n">ledState</span> <span class="o">=</span> <span class="n">ledState</span> <span class="o">|</span> <span class="n">bits</span><span class="p">[</span><span class="n">led</span><span class="p">];}</span> <span class="c1">//if the bit is on we will add it to ledState</span>
   <span class="n">updateLEDs</span><span class="p">(</span><span class="n">ledState</span><span class="p">);</span>              <span class="c1">//send the new LED state to the shift register</span>
<span class="p">}</span>
</pre></div>

<p>So, this program just counts to 128 in binary using red LEDs. Certainly, we can do something more interesting with it!</p>

<div class="highlight highlight-C++"><pre><span class="cm">/*     ---------------------------------------------------------</span>
<span class="cm"> *     |  Arduino Experimentation Kit Example Code             |</span>
<span class="cm"> *     |  CIRC-05 .: 8 More LEDs :. (74HC595 Shift Register)   |</span>
<span class="cm"> *     ---------------------------------------------------------</span>
<span class="cm"> * </span>
<span class="cm"> * We have already controlled 8 LEDs however this does it in a slightly</span>
<span class="cm"> * different manner. Rather than using 8 pins we will use just three</span>
<span class="cm"> * and an additional chip.</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> */</span>


<span class="c1">//Pin Definitions</span>
<span class="c1">//Pin Definitions</span>
<span class="c1">//The 74HC595 uses a serial communication </span>
<span class="c1">//link which has three pins</span>
<span class="kt">int</span> <span class="n">data</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> 
<span class="kt">int</span> <span class="n">clock</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">latch</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>


<span class="c1">//Used for single LED manipulation</span>
<span class="kt">int</span> <span class="n">ledState</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">ON</span> <span class="o">=</span> <span class="n">HIGH</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">OFF</span> <span class="o">=</span> <span class="n">LOW</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">stateArray</span><span class="p">[]</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">};</span> 
<span class="kt">int</span> <span class="n">newStateArray</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
<span class="cm">/*</span>
<span class="cm"> * setup() - this function runs once when you turn your Arduino on</span>
<span class="cm"> * We set the three control pins to outputs</span>
<span class="cm"> */</span>
<span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">pinMode</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">OUTPUT</span><span class="p">);</span>
  <span class="n">pinMode</span><span class="p">(</span><span class="n">clock</span><span class="p">,</span> <span class="n">OUTPUT</span><span class="p">);</span>  
  <span class="n">pinMode</span><span class="p">(</span><span class="n">latch</span><span class="p">,</span> <span class="n">OUTPUT</span><span class="p">);</span>  
<span class="p">}</span>



<span class="cm">/*</span>
<span class="cm"> * loop() - this function will start after setup finishes and then repeat</span>
<span class="cm"> * we set which LEDs we want on then call a routine which sends the states to the 74HC595</span>
<span class="cm"> */</span>
<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span>                     <span class="c1">// run over and over again</span>
<span class="p">{</span>


 <span class="c1">// changeLED(1,1);</span>


    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">7</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
    <span class="n">changeLED</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">stateArray</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>    
  <span class="p">}</span>


  <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">7</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>



    <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span>
      <span class="k">if</span><span class="p">(</span><span class="n">stateArray</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">stateArray</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
        <span class="n">newStateArray</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
       <span class="c1">// changeLED(i,stateArray[i]);</span>
      <span class="p">}</span>

     <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">stateArray</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">stateArray</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span>
        <span class="n">newStateArray</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
       <span class="c1">// changeLED(i,stateArray[i]);</span>
      <span class="p">}</span>

     <span class="k">else</span><span class="p">{</span>
      <span class="n">changeLED</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
      <span class="n">newStateArray</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="o">==</span><span class="mi">7</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">stateArray</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">stateArray</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
        <span class="n">newStateArray</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
     <span class="c1">//   changeLED(i,stateArray[i]);</span>
      <span class="p">}</span>

     <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">stateArray</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">stateArray</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span>
        <span class="n">newStateArray</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
     <span class="c1">//   changeLED(i,stateArray[i]);</span>
      <span class="p">}</span>

     <span class="k">else</span><span class="p">{</span>
      <span class="n">changeLED</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
      <span class="n">newStateArray</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>


  <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">7</span><span class="p">){</span>    

    <span class="k">if</span><span class="p">(</span><span class="n">stateArray</span><span class="p">[</span><span class="n">i</span><span class="o">++</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">stateArray</span><span class="p">[</span><span class="n">i</span><span class="o">--</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
      <span class="n">newStateArray</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="c1">//changeLED(i,stateArray[i]);</span>

    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">stateArray</span><span class="p">[</span><span class="n">i</span><span class="o">--</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">stateArray</span><span class="p">[</span><span class="n">i</span><span class="o">++</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
      <span class="n">newStateArray</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="c1">//  changeLED(i,stateArray[i]);}</span>
  <span class="p">}</span>
    <span class="k">else</span><span class="p">{</span>
      <span class="n">changeLED</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
      <span class="n">newStateArray</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
      <span class="p">}</span>

  <span class="p">}</span>


    <span class="n">delay</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>

      <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">7</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
    <span class="n">stateArray</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">newStateArray</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> 
  <span class="p">}</span> 
  <span class="p">}</span>
<span class="p">}</span>



<span class="cm">/*</span>
<span class="cm"> * updateLEDs() - sends the LED states set in ledStates to the 74HC595</span>
<span class="cm"> * sequence</span>
<span class="cm"> */</span>
<span class="kt">void</span> <span class="nf">updateLEDs</span><span class="p">(</span><span class="kt">int</span> <span class="n">value</span><span class="p">){</span>
  <span class="n">digitalWrite</span><span class="p">(</span><span class="n">latch</span><span class="p">,</span> <span class="n">LOW</span><span class="p">);</span>     <span class="c1">//Pulls the chips latch low</span>
  <span class="n">shiftOut</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">clock</span><span class="p">,</span> <span class="n">MSBFIRST</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span> <span class="c1">//Shifts out the 8 bits to the shift register</span>
  <span class="n">digitalWrite</span><span class="p">(</span><span class="n">latch</span><span class="p">,</span> <span class="n">HIGH</span><span class="p">);</span>   <span class="c1">//Pulls the latch high displaying the data</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * updateLEDsLong() - sends the LED states set in ledStates to the 74HC595</span>
<span class="cm"> * sequence. Same as updateLEDs except the shifting out is done in software</span>
<span class="cm"> * so you can see what is happening.</span>
<span class="cm"> */</span> 
<span class="kt">void</span> <span class="nf">updateLEDsLong</span><span class="p">(</span><span class="kt">int</span> <span class="n">value</span><span class="p">){</span>
  <span class="n">digitalWrite</span><span class="p">(</span><span class="n">latch</span><span class="p">,</span> <span class="n">LOW</span><span class="p">);</span>    <span class="c1">//Pulls the chips latch low</span>
  <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>  <span class="c1">//Will repeat 8 times (once for each bit)</span>
  <span class="kt">int</span> <span class="n">bit</span> <span class="o">=</span> <span class="n">value</span> <span class="o">&amp;</span> <span class="n">B10000000</span><span class="p">;</span> <span class="c1">//We use a "bitmask" to select only the eighth </span>
                               <span class="c1">//bit in our number (the one we are addressing this time through</span>
  <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">;</span>          <span class="c1">//we move our number up one bit value so next time bit 7 will be</span>
                               <span class="c1">//bit 8 and we will do our math on it</span>
  <span class="k">if</span><span class="p">(</span><span class="n">bit</span> <span class="o">==</span> <span class="mi">128</span><span class="p">){</span><span class="n">digitalWrite</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">HIGH</span><span class="p">);}</span> <span class="c1">//if bit 8 is set then set our data pin high</span>
  <span class="k">else</span><span class="p">{</span><span class="n">digitalWrite</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">LOW</span><span class="p">);}</span>            <span class="c1">//if bit 8 is unset then set the data pin low</span>
  <span class="n">digitalWrite</span><span class="p">(</span><span class="n">clock</span><span class="p">,</span> <span class="n">HIGH</span><span class="p">);</span>                <span class="c1">//the next three lines pulse the clock pin</span>
  <span class="n">delay</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="n">digitalWrite</span><span class="p">(</span><span class="n">clock</span><span class="p">,</span> <span class="n">LOW</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">digitalWrite</span><span class="p">(</span><span class="n">latch</span><span class="p">,</span> <span class="n">HIGH</span><span class="p">);</span>  <span class="c1">//pulls the latch high shifting our data into being displayed</span>
<span class="p">}</span>


<span class="c1">//These are used in the bitwise math that we use to change individual LEDs</span>
<span class="c1">//For more details http://en.wikipedia.org/wiki/Bitwise_operation</span>
<span class="kt">int</span> <span class="n">bits</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="n">B00000001</span><span class="p">,</span> <span class="n">B00000010</span><span class="p">,</span> <span class="n">B00000100</span><span class="p">,</span> <span class="n">B00001000</span><span class="p">,</span> <span class="n">B00010000</span><span class="p">,</span> <span class="n">B00100000</span><span class="p">,</span> <span class="n">B01000000</span><span class="p">,</span> <span class="n">B10000000</span><span class="p">};</span>
<span class="kt">int</span> <span class="n">masks</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="n">B11111110</span><span class="p">,</span> <span class="n">B11111101</span><span class="p">,</span> <span class="n">B11111011</span><span class="p">,</span> <span class="n">B11110111</span><span class="p">,</span> <span class="n">B11101111</span><span class="p">,</span> <span class="n">B11011111</span><span class="p">,</span> <span class="n">B10111111</span><span class="p">,</span> <span class="n">B01111111</span><span class="p">};</span>
<span class="cm">/*</span>
<span class="cm"> * changeLED(int led, int state) - changes an individual LED </span>
<span class="cm"> * LEDs are 0 to 7 and state is either 0 - OFF or 1 - ON</span>
<span class="cm"> */</span>
 <span class="kt">void</span> <span class="nf">changeLED</span><span class="p">(</span><span class="kt">int</span> <span class="n">led</span><span class="p">,</span> <span class="kt">int</span> <span class="n">state</span><span class="p">){</span>
   <span class="n">ledState</span> <span class="o">=</span> <span class="n">ledState</span> <span class="o">&amp;</span> <span class="n">masks</span><span class="p">[</span><span class="n">led</span><span class="p">];</span>  <span class="c1">//clears ledState of the bit we are addressing</span>
   <span class="k">if</span><span class="p">(</span><span class="n">state</span> <span class="o">==</span> <span class="n">ON</span><span class="p">){</span><span class="n">ledState</span> <span class="o">=</span> <span class="n">ledState</span> <span class="o">|</span> <span class="n">bits</span><span class="p">[</span><span class="n">led</span><span class="p">];}</span> <span class="c1">//if the bit is on we will add it to ledState</span>
   <span class="n">updateLEDs</span><span class="p">(</span><span class="n">ledState</span><span class="p">);</span>              <span class="c1">//send the new LED state to the shift register</span>
 <span class="p">}</span>
</pre></div>

<p>Here I have changed to code to turn the LEDs into a 1-dimensional Conway's Game of Life with simplified rules (we are pretending that the lights are in a single-file rather than a matrix of 2 by 4): </p>

<pre><code>1. If one (and only one) of your neighbors is ON, turn ON.
2. Else turn OFF
</code></pre>

<p>Conway's Life is a very interesting problem of mathematics and delves into questions of chaos, complexity theory, etc. This implamentation, while very small, has some surprisingly interesting results!</p>

<h3>
<a name="assignment-4-shift-registers-again-bootloaders-multiplexer-and-ir-communication-sort-of" class="anchor" href="#assignment-4-shift-registers-again-bootloaders-multiplexer-and-ir-communication-sort-of"><span class="octicon octicon-link"></span></a>Assignment 4: Shift Registers (again), Bootloaders, Multiplexer and IR-Communication (sort of)</h3>

<p>This lab was a huge pain for a number of reasons: 
a) I forgot to get a second shift-register -- and had to hunt some down. 
b) Some of the instructions on tutorials I found were not particularly clear. 
c) Broken (?) parts. 
d) Uncooperative software</p>

<p>I thought that I would bet ambitious with this assignment -- of course, that only ever leads to not actually getting the assignment done -- but, c'est la vie!</p>

<p><strong><em>Part 1: Chained Shift-Registers</em></strong>
Okay, this first part was my bad. I totally spaced on getting a second shift-register and regretted it. Once I finally procured one -- it went unexpectedly smoothly.        </p>

<p><img src="http://farm8.staticflickr.com/7402/12686578973_7e846e713b.jpg" alt="Good GOD! WHAT HAVE I DONE?!?!"></p>

<p>This set-up makes use of two TI-SN74HC595N's and a very simple daisy-chain method (which I do not have time to draw-up a schematic for at the moment). </p>

<p>With this set-up I shamelessly used the shift-out method provided by the arduino core library -- because re-writing a library by hand is directly against my core beliefs (<a href="http://en.wikipedia.org/wiki/Missionary_Church_of_Kopimism">Kopimism</a>, if you must know). That and I am a) incredibly lazy and b) have no time. </p>

<p>However, I was able to come up with some fun patterns: 
<img src="http://farm4.staticflickr.com/3745/12686548773_c287ac6b9b.jpg" alt=""></p>

<p>The standard "binary counter" (this time with more bits!)</p>

<p><img src="http://farm4.staticflickr.com/3802/12686982104_7df7503039.jpg" alt=""></p>

<p>And, of course, the obligatory "Cylon" pattern -- not quite as interesting, but you 
get the idea. </p>

<p><strong><em>Part 2: Flashing the Boot-loader</em></strong>
To be honest -- I hated doing this. I was worried that I'd brick my board. But I followed the directions on <a href="http://arduino.cc/en/Tutorial/ArduinoISP#.Uwf-2niZi1E">The Arduino website</a> and it worked out just fine. </p>

<p><img src="http://farm3.staticflickr.com/2872/12686739623_669fb05855.jpg" alt=""></p>

<p>Here's an awful picture of my set-up. The link above provides the vague instruction "On the Arduino Uno, you'll need to connect a 10 uF capacitor between reset and ground (after uploading the ArduinoISP sketch)." </p>

<p>Since I am using two Uno's, do I need to connect both to a 10uF capacitor? I wanted to be sure -- so I decided to hunt someone down for advice on #arduino on freenode. Of course, this question was met with sarcastic remarks about how I should use ISP, etc. etc. (typical) -- and I slunk away with a bruised ego and just guessed. Sigh.</p>

<p>Now, despite this process being messy and potentially fatal -- there is good reason to do it. Bootloaders can become corrupted, out-dated, or even not-wanted. Furthermore, you can flash the bootloader with this method to make the arduino connect as a keyboard or some other USB HID. </p>

<p>The due and leonardo (and micro) have this USB HID capability built directly in -- all the user needs to do is to import the mouse and keyboard library. </p>

<p><strong><em>Part 3: Multiplexer</em></strong></p>

<p>Part 3 turned out to be a huge disappointment. My set-up: 
<img src="http://farm8.staticflickr.com/7338/12689007934_bc3eb3e7cf.jpg" alt=""></p>

<p>I was very excited about this part of the assignment as there are so many things that you can do with these little chips. I hooked it up according to the spec. sheet (and made sure to plug the E-bar pin to ground -- as this chip is active when E-bar is low) -- but, alas no output. I tried switching it and reading values in instead, but the value would constantly oscillate no matter what configuration the pins were in. </p>

<p>I therefore, had to conclude that either a) I have no idea what I am doing or b) There is a fault in the multiplexer. </p>

<p>I've ordered a stack of multiplexers, but they've not yet showed up and so I am at a loss. :-/ </p>

<p><strong><em>Part 4: LED Communication</em></strong></p>

<p>Visible light communication is a very interesting (to me) field in ubicomp (ubiquitous computing). And, if you think of it, has been around longer than pretty much any other communications technology.Researchers at <a href="http://www.disneyresearch.com/wp-content/uploads/p1-schmid.pdf">Disney</a> (of all places) have published a few very interesting articles on LED to LED communication. Yes, you can actually use an LED as a RECEIVER! So, I found a <a href="http://playground.arduino.cc/Learning/LEDSensor#.Uwuve3iZi1E">tutorial</a> on how this can be achieved, and decided to try it out.</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Interactive Hardware maintained by <a href="https://github.com/trevortomesh">trevortomesh</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
